{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/Temple4/Temple4/types.ts"],"sourcesContent":["// --- ENUMS ---\n\nexport enum TenantRole {\n  MEMBER = 'MEMBER',\n  STAFF = 'STAFF',\n  CLERGY = 'CLERGY',\n  MODERATOR = 'MODERATOR',\n  ADMIN = 'ADMIN',\n}\n\n// Role types for permission mapping\nexport enum TenantRoleType {\n  MEMBER = 'MEMBER',\n  STAFF = 'STAFF',\n  MODERATOR = 'MODERATOR',\n}\n\nexport enum MembershipStatus {\n  REQUESTED = 'REQUESTED',\n  APPROVED = 'APPROVED',\n  REJECTED = 'REJECTED',\n  BANNED = 'BANNED',\n}\n\nexport enum MembershipApprovalMode {\n  OPEN = 'OPEN',\n  APPROVAL_REQUIRED = 'APPROVAL_REQUIRED',\n}\n\nexport enum VolunteerStatus {\n  CONFIRMED = 'CONFIRMED',\n  CANCELED = 'CANCELED',\n}\n\nexport enum SmallGroupRole {\n  LEADER = 'LEADER',\n  MEMBER = 'MEMBER',\n}\n\nexport enum CommunityPostType {\n    PRAYER_REQUEST = 'PRAYER_REQUEST',\n    TANGIBLE_NEED = 'TANGIBLE_NEED',\n}\n\nexport enum CommunityPostStatus {\n    PENDING_APPROVAL = 'PENDING_APPROVAL',\n    PUBLISHED = 'PUBLISHED',\n    FULFILLED = 'FULFILLED',\n}\n\nexport enum ResourceVisibility {\n    PUBLIC = 'PUBLIC',\n    MEMBERS_ONLY = 'MEMBERS_ONLY',\n}\n\nexport enum FileType {\n    PDF = 'PDF',\n    DOCX = 'DOCX',\n    MP3 = 'MP3',\n    JPG = 'JPG',\n    PNG = 'PNG',\n    OTHER = 'OTHER',\n}\n\nexport enum ContactSubmissionStatus {\n    UNREAD = 'UNREAD',\n    READ = 'READ',\n    ARCHIVED = 'ARCHIVED',\n}\n\n\n// --- USER-RELATED MODELS ---\nexport interface NotificationPreferences {\n  email: {\n    newAnnouncement: boolean;\n    newEvent: boolean;\n    directMessage: boolean;\n    groupChatMessage: boolean;\n    membershipUpdate: boolean;\n  };\n}\n\nexport interface User {\n  id: string;\n  email: string;\n  password?: string; // NOTE: For mock login simulation.\n  isSuperAdmin: boolean;\n  profile: UserProfile;\n  privacySettings: UserPrivacySettings;\n  accountSettings: AccountSettings;\n  notificationPreferences: NotificationPreferences;\n}\n\nexport interface UserProfile {\n  displayName: string;\n  avatarUrl?: string;\n  bio?: string;\n  locationCity?: string;\n  locationCountry?: string;\n  languages?: string[];\n}\n\nexport interface UserPrivacySettings {\n  showAffiliations: boolean;\n}\n\nexport interface AccountSettings {\n  timezonePreference?: string;\n  dateFormat?: string;\n  timeFormat?: string;\n  languagePreference?: string;\n}\n\n\n// --- TENANT-RELATED MODELS ---\n\nexport interface Tenant {\n  id: string;\n  name: string;\n  slug: string;\n  creed: string;\n  address: {\n    street: string;\n    city: string;\n    state: string;\n    country: string;\n    postalCode: string;\n  };\n  contactEmail?: string;\n  phoneNumber?: string;\n  description: string;\n  settings: TenantSettings;\n  branding: TenantBranding;\n  permissions: TenantFeaturePermissions;\n}\n\nexport interface TenantBranding {\n  logoUrl: string;\n  bannerImageUrl: string;\n  primaryColor: string;\n  accentColor: string;\n  customLinks: Array<{ label: string; url: string }>;\n}\n\nexport interface LiveStreamSettings {\n  provider: 'YOUTUBE' | 'FACEBOOK' | 'VIMEO' | 'OTHER';\n  embedUrl: string;\n  isLive: boolean; // Manual toggle by admin\n}\n\nexport interface TenantSettings {\n  isPublic: boolean;\n  membershipApprovalMode: MembershipApprovalMode;\n  // Features\n  enableCalendar: boolean;\n  enablePosts: boolean;\n  enableSermons: boolean;\n  enablePodcasts: boolean;\n  enableBooks: boolean;\n  enableMemberDirectory: boolean;\n  enableGroupChat: boolean;\n  enableComments: boolean;\n  enableReactions: boolean;\n  enableDonations: boolean;\n  enableVolunteering: boolean;\n  enableSmallGroups: boolean;\n  enableLiveStream: boolean;\n  enablePrayerWall: boolean;\n  enableResourceCenter: boolean;\n  donationSettings: DonationSettings;\n  liveStreamSettings: LiveStreamSettings;\n  // Visibility (simplified for mock)\n  visitorVisibility: {\n    calendar: boolean;\n    posts: boolean;\n    sermons: boolean;\n    podcasts: boolean;\n    books: boolean;\n    prayerWall: boolean;\n  };\n}\n\n\nexport interface RolePermissions {\n  canCreatePosts: boolean;\n  canCreateEvents: boolean;\n  canCreateSermons: boolean;\n  canCreatePodcasts: boolean;\n  canCreateBooks: boolean;\n  canCreateGroupChats: boolean;\n  canInviteMembers: boolean;\n  canApproveMembership: boolean;\n  canBanMembers: boolean;\n  canModeratePosts: boolean;\n  canModerateChats: boolean;\n  canPostInAnnouncementChannels?: boolean;\n  canManagePrayerWall: boolean;\n  canUploadResources: boolean;\n  canManageResources: boolean;\n  canManageContactSubmissions: boolean;\n}\n\n// Sticking with a map for easier frontend access\nexport type TenantFeaturePermissions = {\n  [key in TenantRoleType]?: RolePermissions;\n} & { ADMIN: RolePermissions };\n\n\nexport interface UserTenantMembership {\n  id: string;\n  userId: string;\n  tenantId: string;\n  status: MembershipStatus;\n  roles: UserTenantRole[];\n  displayName?: string; // Tenant-specific display name override\n}\n\nexport interface UserTenantRole {\n    id: string;\n    role: TenantRole;\n    displayTitle?: string;\n    isPrimary: boolean;\n}\n\n// Enriched type for displaying members in the UI\nexport interface EnrichedMember extends User {\n  membership: UserTenantMembership;\n}\n\n\n// --- CONTENT & MESSAGING (Largely Unchanged) ---\n\nexport interface Post {\n  id: string;\n  tenantId: string;\n  authorUserId: string;\n  type: 'BLOG' | 'ANNOUNCEMENT' | 'BOOK';\n  title: string;\n  body: string;\n  isPublished: boolean;\n  publishedAt: Date;\n}\nexport interface PostInput {\n  title: string;\n  body: string;\n  type: 'BLOG' | 'ANNOUNCEMENT' | 'BOOK';\n  isPublished: boolean;\n}\nexport interface PostWithAuthor extends Post {\n    authorDisplayName: string;\n    authorAvatarUrl?: string;\n}\n\nexport interface Event {\n  id:string;\n  tenantId: string;\n  createdByUserId: string;\n  title: string;\n  description: string;\n  startDateTime: Date;\n  endDateTime: Date;\n  locationText: string;\n  isOnline: boolean;\n  onlineUrl?: string;\n}\nexport interface EventWithCreator extends Event {\n    creatorDisplayName: string;\n    creatorAvatarUrl?: string;\n}\n\nexport interface MediaItem {\n  id: string;\n  tenantId: string;\n  authorUserId: string;\n  type: 'SERMON_VIDEO' | 'PODCAST_AUDIO';\n  title: string;\n  description: string;\n  embedUrl: string;\n  publishedAt: Date;\n}\nexport interface EnrichedMediaItem extends MediaItem {\n    authorDisplayName: string;\n    authorAvatarUrl?: string;\n}\n\nexport interface ChatMessage {\n  id: string;\n  conversationId: string;\n  userId: string;\n  text: string;\n  createdAt: Date;\n  isDeleted?: boolean;\n}\n\nexport interface EnrichedChatMessage extends ChatMessage {\n  userDisplayName: string;\n  userAvatarUrl?: string;\n}\n\nexport interface Conversation {\n  id: string;\n  isDirect: boolean;\n  tenantId: string | null;\n  isPrivateGroup: boolean;\n  name?: string; // For group channels\n  description?: string; // Description for channels\n  createdByUserId: string;\n  isDefaultChannel: boolean;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface ConversationParticipant {\n  id: string;\n  conversationId: string;\n  userId: string;\n  lastReadMessageId?: string | null;\n}\n\nexport interface EnrichedConversation extends Conversation {\n    participants: User[];\n    unreadCount: number;\n    lastMessage?: EnrichedChatMessage;\n    displayName: string;\n}\n\n\n// --- ADMIN & AUDIT TYPES ---\n\nexport enum ActionType {\n  IMPERSONATE_START = 'IMPERSONATE_START',\n  IMPERSONATE_END = 'IMPERSONATE_END',\n  CREATE_POST = 'CREATE_POST',\n  DELETE_POST = 'DELETE_POST',\n  BAN_USER = 'BAN_USER',\n  UNBAN_USER = 'UNBAN_USER',\n  DELETE_MESSAGE = 'DELETE_MESSAGE',\n  USER_JOINED_TENANT = 'USER_JOINED_TENANT',\n  MEMBERSHIP_STATUS_UPDATED = 'MEMBERSHIP_STATUS_UPDATED',\n  MEMBER_ROLES_UPDATED = 'MEMBER_ROLES_UPDATED',\n  MEMBERSHIP_PROFILE_UPDATED = 'MEMBERSHIP_PROFILE_UPDATED',\n  USER_REGISTERED = 'USER_REGISTERED',\n  USER_PROFILE_UPDATED = 'USER_PROFILE_UPDATED',\n  ADMIN_UPDATED_USER_PROFILE = 'ADMIN_UPDATED_USER_PROFILE',\n  TENANT_PERMISSIONS_UPDATED = 'TENANT_PERMISSIONS_UPDATED',\n}\n\nexport interface AuditLog {\n  id: string;\n  actorUserId: string;\n  effectiveUserId?: string;\n  actionType: ActionType;\n  entityType?: string;\n  entityId?: string;\n  metadata?: Record<string, any>;\n  createdAt: Date;\n}\n\n// --- NOTIFICATION MODELS ---\nexport type NotificationType =\n  | 'NEW_DIRECT_MESSAGE'\n  | 'NEW_ANNOUNCEMENT'\n  | 'MEMBERSHIP_APPROVED'\n  | 'NEW_CONTACT_SUBMISSION';\n\nexport interface Notification {\n  id: string;\n  userId: string; // The recipient\n  actorUserId?: string; // The user who caused the notification\n  type: NotificationType;\n  message: string;\n  link?: string; // e.g., messages, tenant/tenant-1\n  isRead: boolean;\n  createdAt: Date;\n}\n\n// --- DONATION MODELS ---\nexport interface DonationSettings {\n  mode: 'EXTERNAL' | 'INTEGRATED';\n  externalUrl?: string;\n  integratedProvider?: 'STRIPE' | 'PAYPAL';\n  currency: string;\n  suggestedAmounts: number[];\n  allowCustomAmounts: boolean;\n  leaderboardEnabled: boolean;\n  leaderboardVisibility: 'PUBLIC' | 'MEMBERS_ONLY';\n  leaderboardTimeframe: 'ALL_TIME' | 'YEARLY' | 'MONTHLY';\n}\n\nexport interface DonationRecord {\n  id: string;\n  tenantId: string;\n  userId: string | null; // null for anonymous from public page\n  displayName: string; // denormalized for anonymous/guest donations\n  amount: number;\n  currency: string;\n  donatedAt: Date;\n  isAnonymousOnLeaderboard: boolean;\n  message?: string;\n}\n\nexport interface EnrichedDonationRecord extends DonationRecord {\n    userAvatarUrl?: string;\n}\n\n// --- VOLUNTEER MODELS ---\nexport interface VolunteerNeed {\n  id: string;\n  tenantId: string;\n  eventId?: string; // Optional link to an Event\n  title: string;\n  description: string;\n  date: Date;\n  slotsNeeded: number;\n}\n\nexport interface VolunteerSignup {\n  id: string;\n  needId: string;\n  userId: string;\n  signedUpAt: Date;\n  status: VolunteerStatus;\n}\n\n// Enriched types for UI\nexport interface EnrichedSignup {\n  signup: VolunteerSignup;\n  user: User;\n}\n\nexport interface EnrichedVolunteerNeed extends VolunteerNeed {\n  signups: EnrichedSignup[];\n}\n\n// --- SMALL GROUP MODELS ---\nexport interface SmallGroup {\n  id: string;\n  tenantId: string;\n  name: string;\n  description: string;\n  leaderUserId: string;\n  meetingSchedule: string; // e.g., \"Tuesdays at 7 PM\"\n  isActive: boolean;\n}\n\nexport interface SmallGroupMembership {\n  id: string;\n  groupId: string;\n  userId: string;\n  role: SmallGroupRole;\n  joinedAt: Date;\n}\n\n// Enriched types for UI\nexport interface EnrichedGroupMember {\n    membership: SmallGroupMembership;\n    user: User;\n}\n\nexport interface EnrichedSmallGroup extends SmallGroup {\n    leader: User;\n    members: EnrichedGroupMember[];\n}\n\n// --- COMMUNITY BOARD / PRAYER WALL MODELS ---\nexport interface CommunityPost {\n    id: string;\n    tenantId: string;\n    authorUserId: string | null; // Null for anonymous\n    type: CommunityPostType;\n    body: string;\n    isAnonymous: boolean;\n    status: CommunityPostStatus;\n    createdAt: Date;\n}\n\nexport interface EnrichedCommunityPost extends CommunityPost {\n    authorDisplayName: string;\n    authorAvatarUrl?: string;\n}\n\n// --- RESOURCE CENTER MODELS ---\nexport interface ResourceItem {\n    id: string;\n    tenantId: string;\n    uploaderUserId: string;\n    title: string;\n    description: string;\n    fileUrl: string; // For mock, this is just a string. In real app, it would be a URL to a file.\n    fileType: FileType;\n    visibility: ResourceVisibility;\n    createdAt: Date;\n}\n\nexport interface EnrichedResourceItem extends ResourceItem {\n    uploaderDisplayName: string;\n    uploaderAvatarUrl?: string;\n}\n\n// --- CONTACT & SUBMISSIONS ---\nexport interface ContactSubmission {\n    id: string;\n    tenantId: string;\n    name: string;\n    email: string;\n    message: string;\n    status: ContactSubmissionStatus;\n    createdAt: Date;\n}"],"names":[],"mappings":"AAAA,gBAAgB;;;;;;;;;;;;;;;;;;;;;;;;;;;AAET,IAAA,AAAK,oCAAA;;;;;;WAAA;;AASL,IAAA,AAAK,wCAAA;;;;WAAA;;AAML,IAAA,AAAK,0CAAA;;;;;WAAA;;AAOL,IAAA,AAAK,gDAAA;;;WAAA;;AAKL,IAAA,AAAK,yCAAA;;;WAAA;;AAKL,IAAA,AAAK,wCAAA;;;WAAA;;AAKL,IAAA,AAAK,2CAAA;;;WAAA;;AAKL,IAAA,AAAK,6CAAA;;;;WAAA;;AAML,IAAA,AAAK,4CAAA;;;WAAA;;AAKL,IAAA,AAAK,kCAAA;;;;;;;WAAA;;AASL,IAAA,AAAK,iDAAA;;;;WAAA;;AAyQL,IAAA,AAAK,oCAAA;;;;;;;;;;;;;;;;WAAA"}},
    {"offset": {"line": 144, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/Temple4/Temple4/lib/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\ndeclare global {\n  // allow global `var` declarations\n  // eslint-disable-next-line no-var\n  var prisma: PrismaClient | undefined;\n}\n\nexport const prisma =\n  globalThis.prisma ||\n  new PrismaClient();\n\nif (process.env.NODE_ENV !== 'production') globalThis.prisma = prisma;\n"],"names":[],"mappings":";;;;AAAA;;AAQO,MAAM,SACX,WAAW,MAAM,IACjB,IAAI,6IAAY;AAElB,wCAA2C,WAAW,MAAM,GAAG"}},
    {"offset": {"line": 162, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/Temple4/Temple4/lib/data.ts"],"sourcesContent":["import { prisma } from './db';\nimport { Tenant, User, Post, Event, UserTenantMembership, Notification, AuditLog, Conversation, TenantRole, MembershipStatus, TenantSettings, TenantBranding } from '@prisma/client';\nimport bcrypt from 'bcryptjs';\n\ntype TenantWithDetails = Tenant & {\n    settings: TenantSettings | null;\n    branding: TenantBranding | null;\n};\n\nexport async function getTenantsForUser(userId: string): Promise<Tenant[]> {\n  const memberships = await prisma.userTenantMembership.findMany({\n    where: {\n      userId: userId,\n      status: 'APPROVED',\n    },\n    include: {\n      tenant: true,\n    },\n  });\n\n  return memberships.map((membership: { tenant: Tenant; }) => membership.tenant);\n}\n\nexport async function getTenantById(tenantId: string) {\n  return await prisma.tenant.findUnique({\n    where: { id: tenantId },\n    include: {\n      settings: true,\n      branding: true,\n    },\n  });\n}\n\nexport async function getUserById(userId: string) {\n  return await prisma.user.findUnique({\n    where: { id: userId },\n    include: {\n      profile: true,\n      privacySettings: true,\n      accountSettings: true,\n    },\n  });\n}\n\nexport async function getTenants(): Promise<Tenant[]> {\n    const tenants = await prisma.tenant.findMany({\n        include: {\n            settings: true,\n            branding: true,\n        }\n    });\n    \n    // Transform Prisma data to match Tenant interface with nested address\n    return tenants.map(tenant => ({\n        ...tenant,\n        address: {\n            street: tenant.street,\n            city: tenant.city,\n            state: tenant.state,\n            country: tenant.country,\n            postalCode: tenant.postalCode,\n        },\n        settings: tenant.settings || {\n            isPublic: true,\n            allowMemberDirectory: true,\n            allowEvents: true,\n            allowDonations: true,\n            allowSmallGroups: true,\n            allowMessaging: true,\n        },\n        branding: tenant.branding || {\n            logoUrl: '',\n            bannerImageUrl: '',\n            primaryColor: '#d97706',\n            accentColor: '#92400e',\n        },\n        permissions: tenant.permissions as any || {},\n    })) as Tenant[];\n}\n\nexport async function getEventsForTenant(tenantId: string): Promise<Event[]> {\n  return await prisma.event.findMany({\n    where: { tenantId },\n    orderBy: { startDateTime: 'asc' },\n  });\n}\n\nexport async function getPostsForTenant(tenantId: string): Promise<Post[]> {\n  return await prisma.post.findMany({\n    where: { tenantId, isPublished: true },\n    orderBy: { publishedAt: 'desc' },\n    include: {\n      author: {\n        include: {\n          profile: true,\n        }\n      }\n    }\n  });\n}\n\nexport async function getMembershipForUserInTenant(userId: string, tenantId: string): Promise<UserTenantMembership | null> {\n  return await prisma.userTenantMembership.findUnique({\n    where: {\n      userId_tenantId: {\n        userId,\n        tenantId,\n      }\n    },\n  });\n}\n\nexport async function getNotificationsForUser(userId: string): Promise<Notification[]> {\n    return await prisma.notification.findMany({\n        where: { userId },\n        orderBy: { createdAt: 'desc' },\n    });\n}\n\nexport async function markNotificationAsRead(notificationId: string): Promise<Notification> {\n    return await prisma.notification.update({\n        where: { id: notificationId },\n        data: { isRead: true },\n    });\n}\n\nexport async function markAllNotificationsAsRead(userId: string) {\n    return await prisma.notification.updateMany({\n        where: { userId },\n        data: { isRead: true },\n    });\n}\n\nexport async function getUserByEmail(email: string) {\n    return await prisma.user.findUnique({\n        where: { email },\n        include: {\n            profile: true,\n            privacySettings: true,\n            accountSettings: true,\n        },\n    });\n}\n\nexport async function registerUser(displayName: string, email: string, pass: string) {\n    const existingUser = await getUserByEmail(email);\n    if (existingUser) {\n        return { success: false, message: 'User with this email already exists.' };\n    }\n    const hashedPassword = await bcrypt.hash(pass, 10);\n    const user = await prisma.user.create({\n        data: {\n            email,\n            password: hashedPassword,\n            profile: {\n                create: {\n                    displayName,\n                },\n            },\n            accountSettings: { create: {} },\n            privacySettings: { create: {} },\n        },\n        include: {\n            profile: true,\n            privacySettings: true,\n            accountSettings: true,\n        }\n    });\n    return { success: true, user };\n}\n\nexport async function createTenant(tenantDetails: Omit<Tenant, 'id' | 'slug' | 'permissions'>, ownerId: string): Promise<Tenant> {\n    const tenant = await prisma.tenant.create({\n        data: {\n            ...tenantDetails,\n            slug: tenantDetails.name.toLowerCase().replace(/ /g, '-'),\n            memberships: {\n                create: {\n                    userId: ownerId,\n                    roles: {\n                        create: {\n                            role: TenantRole.ADMIN,\n                        }\n                    },\n                    status: MembershipStatus.APPROVED,\n                }\n            },\n            settings: { \n                create: {\n                    isPublic: false,\n                    membershipApprovalMode: 'APPROVAL_REQUIRED',\n                    enableCalendar: true,\n                    enablePosts: true,\n                    enableSermons: true,\n                    enablePodcasts: true,\n                    enableBooks: true,\n                    enableDonations: true,\n                    enableVolunteering: true,\n                    enableSmallGroups: true,\n                    enableLiveStream: true,\n                    enablePrayerWall: true,\n                    enableResourceCenter: true,\n                    visitorVisibility: {},\n                    donationSettings: {},\n                    liveStreamSettings: {},\n                } \n            },\n            branding: { \n                create: {\n                    logoUrl: '',\n                    bannerImageUrl: '',\n                    primaryColor: '#000000',\n                    accentColor: '#FFFFFF',\n                    customLinks: [],\n                } \n            },\n        }\n    });\n    return tenant;\n}\n\nexport async function updateTenant(tenant: Partial<TenantWithDetails>): Promise<Tenant> {\n    const { id, settings, branding, ...data } = tenant;\n    \n    const updateData: any = { ...data };\n\n    if (settings) {\n        const { id: settingsId, tenantId: settingsTenantId, ...restOfSettings } = settings;\n        updateData.settings = {\n            update: {\n                ...restOfSettings,\n                visitorVisibility: restOfSettings.visitorVisibility || undefined,\n                donationSettings: restOfSettings.donationSettings || undefined,\n                liveStreamSettings: restOfSettings.liveStreamSettings || undefined,\n            }\n        };\n    }\n\n    if (branding) {\n        const { id: brandingId, tenantId: brandingTenantId, ...restOfBranding } = branding;\n        updateData.branding = {\n            update: {\n                ...restOfBranding,\n                customLinks: restOfBranding.customLinks || undefined,\n            }\n        };\n    }\n\n    return await prisma.tenant.update({\n        where: { id },\n        data: updateData,\n    });\n}\n\nexport async function requestToJoinTenant(userId: string, tenantId: string): Promise<UserTenantMembership> {\n    const existingMembership = await getMembershipForUserInTenant(userId, tenantId);\nif (existingMembership) {\n        return existingMembership;\n    }\n    return await prisma.userTenantMembership.create({\n        data: {\n            userId,\n            tenantId,\n            roles: {\n                create: {\n                    role: TenantRole.MEMBER,\n                }\n            },\n            status: MembershipStatus.PENDING,\n        }\n    });\n}\n\n// NOTE: These are not secure and are for demonstration only.\n// In a real app, you'd use secure tokens and a proper reset flow.\nexport async function requestPasswordReset(email: string): Promise<boolean> {\n    const user = await getUserByEmail(email);\n    if (!user) return false;\n    // In a real app, generate a token, save it, and email a link.\n    console.log(`Password reset requested for ${email}. In this demo, we'll just allow a direct reset.`);\n    return true;\n}\n\nexport async function resetPassword(email: string, newPass: string) {\n    const user = await getUserByEmail(email);\n    if (!user) return { success: false, message: \"User not found.\" };\n    const hashedPassword = await bcrypt.hash(newPass, 10);\n    await prisma.user.update({\n        where: { email },\n        data: { password: hashedPassword },\n    });\n    return { success: true };\n}\n\nexport async function logAuditEvent(event: Omit<AuditLog, 'id' | 'createdAt'>): Promise<AuditLog> {\n    return await prisma.auditLog.create({\n        data: {\n            ...event,\n            metadata: event.metadata || {},\n        },\n    });\n}\n\nexport async function getOrCreateDirectConversation(userId1: string, userId2: string): Promise<Conversation> {\n    const existing = await prisma.conversation.findFirst({\n        where: {\n            isDirectMessage: true,\n            participants: {\n                every: {\n                    userId: { in: [userId1, userId2] }\n                }\n            }\n        },\n        include: { participants: true }\n    });\n\n    if (existing) return existing;\n\n    return await prisma.conversation.create({\n        data: {\n            isDirectMessage: true,\n            participants: {\n                create: [\n                    { userId: userId1 },\n                    { userId: userId2 },\n                ]\n            }\n        }\n    });\n}\n\nexport async function getConversationsForUser(userId: string) {\n    return await prisma.conversation.findMany({\n        where: {\n            participants: {\n                some: {\n                    userId: userId\n                }\n            }\n        },\n        include: {\n            participants: {\n                include: {\n                    user: {\n                        include: {\n                            profile: true\n                        }\n                    }\n                }\n            },\n            messages: {\n                orderBy: {\n                    createdAt: 'desc'\n                },\n                take: 1,\n                include: {\n                    user: {\n                        include: {\n                            profile: true\n                        }\n                    }\n                }\n            }\n        },\n        orderBy: {\n            id: 'desc'\n        }\n    });\n}\n\nexport async function getMessagesForConversation(conversationId: string) {\n    return await prisma.chatMessage.findMany({\n        where: {\n            conversationId: conversationId\n        },\n        include: {\n            user: {\n                include: {\n                    profile: true\n                }\n            }\n        },\n        orderBy: {\n            createdAt: 'asc'\n        }\n    });\n}\n\nexport async function addMessage(conversationId: string, senderId: string, content: string) {\n    const message = await prisma.chatMessage.create({\n        data: {\n            conversationId,\n            userId: senderId,\n            text: content\n        },\n        include: {\n            user: {\n                include: {\n                    profile: true\n                }\n            }\n        }\n    });\n\n    return message;\n}\n\nexport async function deleteMessage(messageId: string) {\n    return await prisma.chatMessage.delete({\n        where: { id: messageId }\n    });\n}\n\nexport async function markConversationAsRead(conversationId: string, userId: string) {\n    // This would update read receipts via ConversationParticipant's lastReadMessageId\n    // For now, just return success\n    return { success: true };\n}\n\nexport async function getAllUsers() {\n    return await prisma.user.findMany({\n        include: {\n            profile: true\n        }\n    });\n}\n\nexport async function getAuditLogs() {\n    return await prisma.auditLog.findMany({\n        include: {\n            actorUser: {\n                include: {\n                    profile: true\n                }\n            },\n            effectiveUser: {\n                include: {\n                    profile: true\n                }\n            }\n        },\n        orderBy: {\n            createdAt: 'desc'\n        },\n        take: 100\n    });\n}\n\n// Get enriched memberships for a user (includes tenant details)\nexport async function getEnrichedMembershipsForUser(userId: string) {\n    const memberships = await prisma.userTenantMembership.findMany({\n        where: { userId },\n        include: {\n            tenant: {\n                include: {\n                    settings: true,\n                    branding: true,\n                }\n            }\n        }\n    });\n    \n    return memberships.map(m => ({\n        membership: m,\n        tenant: m.tenant\n    }));\n}\n\n// Update membership profile (display name and title within a tenant)\nexport async function updateMembershipProfile(\n    userId: string, \n    membershipId: string, \n    data: { displayName?: string; displayTitle?: string }\n) {\n    return await prisma.userTenantMembership.update({\n        where: { id: membershipId, userId },\n        data: {\n            displayName: data.displayName,\n            displayTitle: data.displayTitle\n        }\n    });\n}\n\n// Update user notification preferences\nexport async function updateUserNotificationPreferences(\n    userId: string,\n    preferences: any\n) {\n    // Note: This assumes notification preferences are stored in a JSON field or separate table\n    // Adjust based on your actual schema\n    return await prisma.user.update({\n        where: { id: userId },\n        data: {\n            // If you have a notificationPreferences JSON field:\n            // notificationPreferences: preferences\n        }\n    });\n}\n\n// ===== MISSING FUNCTION STUBS =====\n// These functions are called by components but not yet fully implemented\n\nexport async function getMembersForTenant(tenantId: string) {\n    // TODO: Implement member fetching with enriched data\n    return [];\n}\n\nexport async function updateMembershipStatus(userId: string, tenantId: string, status: string) {\n    // TODO: Implement membership status update\n    return null;\n}\n\nexport async function updateMemberRolesAndTitle(userId: string, tenantId: string, roles: any[], title: string) {\n    // TODO: Implement member roles and title update\n    return null;\n}\n\nexport async function getSmallGroupsForTenant(tenantId: string) {\n    // TODO: Implement small groups fetching\n    return [];\n}\n\nexport async function createSmallGroup(tenantId: string, groupData: any) {\n    // TODO: Implement small group creation\n    return null;\n}\n\nexport async function getVolunteerNeedsForTenant(tenantId: string) {\n    // TODO: Implement volunteer needs fetching\n    return [];\n}\n\nexport async function addVolunteerNeed(tenantId: string, needData: any) {\n    // TODO: Implement volunteer need creation\n    return null;\n}\n\nexport async function getResourceItemsForTenant(tenantId: string) {\n    // TODO: Implement resource items fetching\n    return [];\n}\n\nexport async function addResourceItem(tenantId: string, itemData: any) {\n    // TODO: Implement resource item creation\n    return null;\n}\n\nexport async function deleteResourceItem(itemId: string) {\n    // TODO: Implement resource item deletion\n    return null;\n}\n\nexport async function getCommunityPostsForTenant(tenantId: string) {\n    // TODO: Implement community posts fetching\n    return [];\n}\n\nexport async function updateCommunityPostStatus(postId: string, status: string) {\n    // TODO: Implement community post status update\n    return null;\n}\n\nexport async function getContactSubmissionsForTenant(tenantId: string) {\n    // TODO: Implement contact submissions fetching\n    return [];\n}\n\nexport async function updateContactSubmissionStatus(submissionId: string, status: string) {\n    // TODO: Implement contact submission status update\n    return null;\n}\n\nexport async function respondToContactSubmission(submissionId: string, response: string) {\n    // TODO: Implement contact submission response\n    return null;\n}\n\nexport async function updateTenantPermissions(tenantId: string, permissions: any) {\n    // TODO: Implement tenant permissions update\n    return null;\n}\n\nexport async function addPost(tenantId: string, postData: any) {\n    // TODO: Implement post creation\n    return null;\n}\n\nexport async function addEvent(tenantId: string, eventData: any) {\n    // TODO: Implement event creation\n    return null;\n}\n\nexport async function getSermonsForTenant(tenantId: string) {\n    // TODO: Implement sermons fetching\n    return [];\n}\n\nexport async function getPodcastsForTenant(tenantId: string) {\n    // TODO: Implement podcasts fetching\n    return [];\n}\n\nexport async function getBooksForTenant(tenantId: string) {\n    // TODO: Implement books fetching\n    return [];\n}\n\nexport async function getDonationsForTenant(tenantId: string) {\n    // TODO: Implement donations fetching\n    return [];\n}\n\nexport async function addDonationRecord(tenantId: string, donationData: any) {\n    // TODO: Implement donation record creation\n    return null;\n}\n\nexport async function addContactSubmission(tenantId: string, submissionData: any) {\n    // TODO: Implement contact submission creation\n    return null;\n}\n\nexport async function addCommunityPost(tenantId: string, postData: any) {\n    // TODO: Implement community post creation\n    return null;\n}\n\nexport async function joinSmallGroup(groupId: string, userId: string) {\n    // TODO: Implement small group join\n    return null;\n}\n\nexport async function leaveSmallGroup(groupId: string, userId: string) {\n    // TODO: Implement small group leave\n    return null;\n}\n\nexport async function signUpForNeed(needId: string, userId: string) {\n    // TODO: Implement volunteer need sign up\n    return null;\n}\n\nexport async function cancelSignUp(needId: string, userId: string) {\n    // TODO: Implement volunteer need cancellation\n    return null;\n}\n\nexport async function createConversation(conversationData: any) {\n    // TODO: Implement conversation creation\n    return null;\n}\n\nexport async function adminUpdateUserProfile(userId: string, profileData: any) {\n    // TODO: Implement admin user profile update\n    return null;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 927, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/Temple4/Temple4/app/components/ui/Button.tsx"],"sourcesContent":["import React from 'react';\n\ninterface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  variant?: 'primary' | 'secondary' | 'danger';\n  size?: 'sm' | 'md';\n  children: React.ReactNode;\n}\n\nconst Button: React.FC<ButtonProps> = ({ children, variant = 'primary', size = 'md', className, ...props }) => {\n  const baseClasses = \"rounded-md font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\";\n\n  const variantClasses = {\n    primary: 'bg-amber-600 text-white hover:bg-amber-700 focus:ring-amber-500',\n    secondary: 'bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-400',\n    danger: 'bg-red-600 text-white hover:bg-red-700 focus:ring-red-500',\n  };\n  \n  const sizeClasses = {\n      md: \"px-4 py-2 text-sm\",\n      sm: \"px-3 py-1.5 text-xs\",\n  }\n\n  return (\n    <button className={`${baseClasses} ${variantClasses[variant]} ${sizeClasses[size]} ${className}`} {...props}>\n      {children}\n    </button>\n  );\n};\n\nexport default Button;\n"],"names":[],"mappings":";;;;;;AAQA,MAAM,SAAgC,CAAC,EAAE,QAAQ,EAAE,UAAU,SAAS,EAAE,OAAO,IAAI,EAAE,SAAS,EAAE,GAAG,OAAO;IACxG,MAAM,cAAc;IAEpB,MAAM,iBAAiB;QACrB,SAAS;QACT,WAAW;QACX,QAAQ;IACV;IAEA,MAAM,cAAc;QAChB,IAAI;QACJ,IAAI;IACR;IAEA,qBACE,8OAAC;QAAO,WAAW,GAAG,YAAY,CAAC,EAAE,cAAc,CAAC,QAAQ,CAAC,CAAC,EAAE,WAAW,CAAC,KAAK,CAAC,CAAC,EAAE,WAAW;QAAG,GAAG,KAAK;kBACxG;;;;;;AAGP;uCAEe"}},
    {"offset": {"line": 959, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/Temple4/Temple4/app/components/ui/Card.tsx"],"sourcesContent":["\nimport React from 'react';\n\ninterface CardProps {\n  children: React.ReactNode;\n  className?: string;\n  title?: string;\n  description?: string;\n}\n\nconst Card: React.FC<CardProps> = ({ children, className, title, description }) => {\n  return (\n    <div className={`bg-white shadow-md rounded-lg overflow-hidden ${className}`}>\n        {title && (\n            <div className=\"p-6 border-b border-gray-200\">\n                <h3 className=\"text-lg font-semibold leading-6 text-gray-900\">{title}</h3>\n                {description && <p className=\"mt-1 text-sm text-gray-500\">{description}</p>}\n            </div>\n        )}\n      <div className=\"p-6\">\n        {children}\n      </div>\n    </div>\n  );\n};\n\nexport default Card;\n"],"names":[],"mappings":";;;;;;AAUA,MAAM,OAA4B,CAAC,EAAE,QAAQ,EAAE,SAAS,EAAE,KAAK,EAAE,WAAW,EAAE;IAC5E,qBACE,8OAAC;QAAI,WAAW,CAAC,8CAA8C,EAAE,WAAW;;YACvE,uBACG,8OAAC;gBAAI,WAAU;;kCACX,8OAAC;wBAAG,WAAU;kCAAiD;;;;;;oBAC9D,6BAAe,8OAAC;wBAAE,WAAU;kCAA8B;;;;;;;;;;;;0BAGrE,8OAAC;gBAAI,WAAU;0BACZ;;;;;;;;;;;;AAIT;uCAEe"}},
    {"offset": {"line": 1014, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/Temple4/Temple4/app/components/admin/AdminConsole.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useMemo, useEffect } from 'react';\nimport type { User, AuditLog } from '@/types';\nimport { ActionType } from '@/types';\nimport { getAuditLogs, getAllUsers } from '@/lib/data';\nimport Button from '../ui/Button';\nimport Card from '../ui/Card';\n\ninterface AdminConsoleProps {\n  onBack: () => void;\n}\n\ninterface EnrichedAuditLog extends AuditLog {\n    actorDisplayName: string;\n    effectiveDisplayName?: string;\n}\n\nconst AdminConsole: React.FC<AdminConsoleProps> = ({ onBack }) => {\n  const [logs, setLogs] = useState<AuditLog[]>([]);\n  const [users, setUsers] = useState<User[]>([]);\n  const [loading, setLoading] = useState(true);\n  \n  useEffect(() => {\n    async function fetchData() {\n      try {\n        const [logsData, usersData] = await Promise.all([\n          getAuditLogs(),\n          getAllUsers()\n        ]);\n        setLogs(logsData);\n        setUsers(usersData);\n      } catch (error) {\n        console.error('Error fetching admin data:', error);\n      } finally {\n        setLoading(false);\n      }\n    }\n    fetchData();\n  }, []);\n  \n  const [actorFilter, setActorFilter] = useState<string>('all');\n  const [actionFilter, setActionFilter] = useState<string>('all');\n  const [startDateFilter, setStartDateFilter] = useState<string>('');\n  const [endDateFilter, setEndDateFilter] = useState<string>('');\n  \n  const usersMap = useMemo(() => {\n    const map = new Map<string, User>();\n    users.forEach(user => map.set(user.id, user));\n    return map;\n  }, [users]);\n  \n  const enrichedLogs: EnrichedAuditLog[] = useMemo(() => {\n    return logs.map(log => ({\n        ...log,\n        actorDisplayName: usersMap.get(log.actorUserId)?.profile?.displayName || log.actorUserId,\n        effectiveDisplayName: log.effectiveUserId ? (usersMap.get(log.effectiveUserId)?.profile?.displayName || log.effectiveUserId) : undefined,\n    }));\n  }, [logs, usersMap]);\n  \n  const filteredLogs = useMemo(() => {\n    return enrichedLogs.filter(log => {\n      if (actorFilter !== 'all' && log.actorUserId !== actorFilter) return false;\n      if (actionFilter !== 'all' && log.actionType !== actionFilter) return false;\n      if (startDateFilter) {\n          const startDate = new Date(startDateFilter);\n          if (log.createdAt < startDate) return false;\n      }\n      if (endDateFilter) {\n          const endDate = new Date(endDateFilter);\n          endDate.setHours(23, 59, 59, 999); // Include the whole day\n          if (log.createdAt > endDate) return false;\n      }\n      return true;\n    });\n  }, [enrichedLogs, actorFilter, actionFilter, startDateFilter, endDateFilter]);\n\n  if (loading) {\n    return (\n      <div className=\"space-y-8\">\n        <div className=\"flex justify-between items-center\">\n          <h1 className=\"text-3xl font-bold text-gray-900\">Admin Console: Audit Log</h1>\n        </div>\n        <div className=\"text-center py-8\">Loading...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-8\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Admin Console: Audit Log</h1>\n          <p className=\"text-sm text-gray-500\">View and filter all audited actions across the platform.</p>\n        </div>\n        <Button variant=\"secondary\" onClick={onBack}>&larr; Back</Button>\n      </div>\n\n      <Card title=\"Filter Logs\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n            <div>\n                <label htmlFor=\"actor-filter\" className=\"block text-sm font-medium text-gray-700 mb-1\">Actor</label>\n                <select id=\"actor-filter\" value={actorFilter} onChange={e => setActorFilter(e.target.value)} className=\"w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-amber-500 focus:border-amber-500 sm:text-sm bg-white text-gray-900\">\n                    <option value=\"all\">All Users</option>\n                    {users.map(user => <option key={user.id} value={user.id}>{user.profile.displayName}</option>)}\n                </select>\n            </div>\n            <div>\n                <label htmlFor=\"action-filter\" className=\"block text-sm font-medium text-gray-700 mb-1\">Action Type</label>\n                <select id=\"action-filter\" value={actionFilter} onChange={e => setActionFilter(e.target.value)} className=\"w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-amber-500 focus:border-amber-500 sm:text-sm bg-white text-gray-900\">\n                    <option value=\"all\">All Actions</option>\n                    {Object.values(ActionType).map(action => <option key={action} value={action}>{action}</option>)}\n                </select>\n            </div>\n            <div>\n                <label htmlFor=\"start-date\" className=\"block text-sm font-medium text-gray-700 mb-1\">Start Date</label>\n                <input type=\"date\" id=\"start-date\" value={startDateFilter} onChange={e => setStartDateFilter(e.target.value)} className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-amber-500 focus:border-amber-500 sm:text-sm bg-white text-gray-900\"/>\n            </div>\n            <div>\n                <label htmlFor=\"end-date\" className=\"block text-sm font-medium text-gray-700 mb-1\">End Date</label>\n                <input type=\"date\" id=\"end-date\" value={endDateFilter} onChange={e => setEndDateFilter(e.target.value)} className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-amber-500 focus:border-amber-500 sm:text-sm bg-white text-gray-900\"/>\n            </div>\n        </div>\n      </Card>\n      \n      <div className=\"flow-root\">\n        <div className=\"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8\">\n            <div className=\"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8\">\n                <div className=\"overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg\">\n                    <table className=\"min-w-full divide-y divide-gray-300\">\n                        <thead className=\"bg-gray-50\">\n                            <tr>\n                                <th scope=\"col\" className=\"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6\">Date</th>\n                                <th scope=\"col\" className=\"px-3 py-3.5 text-left text-sm font-semibold text-gray-900\">Actor</th>\n                                <th scope=\"col\" className=\"px-3 py-3.5 text-left text-sm font-semibold text-gray-900\">Effective User</th>\n                                <th scope=\"col\" className=\"px-3 py-3.5 text-left text-sm font-semibold text-gray-900\">Action</th>\n                                <th scope=\"col\" className=\"px-3 py-3.5 text-left text-sm font-semibold text-gray-900\">Entity</th>\n                                <th scope=\"col\" className=\"px-3 py-3.5 text-left text-sm font-semibold text-gray-900\">Details</th>\n                            </tr>\n                        </thead>\n                        <tbody className=\"divide-y divide-gray-200 bg-white\">\n                            {filteredLogs.map(log => (\n                                <tr key={log.id}>\n                                    <td className=\"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6\">{log.createdAt.toLocaleString()}</td>\n                                    <td className=\"whitespace-nowrap px-3 py-4 text-sm text-gray-500\">{log.actorDisplayName}</td>\n                                    <td className=\"whitespace-nowrap px-3 py-4 text-sm text-gray-500\">{log.effectiveDisplayName || 'N/A'}</td>\n                                    <td className=\"whitespace-nowrap px-3 py-4 text-sm text-gray-500\">{log.actionType}</td>\n                                    <td className=\"whitespace-nowrap px-3 py-4 text-sm text-gray-500\">{log.entityType ? `${log.entityType} (${log.entityId})` : 'N/A'}</td>\n                                    <td className=\"px-3 py-4 text-xs text-gray-500\">\n                                        {log.metadata && <pre className=\"bg-gray-100 p-2 rounded whitespace-pre-wrap max-w-sm\">{JSON.stringify(log.metadata, null, 2)}</pre>}\n                                    </td>\n                                </tr>\n                            ))}\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AdminConsole;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1524, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/Temple4/Temple4/app/admin/page.tsx"],"sourcesContent":["'use client';\n\nimport { useSession } from 'next-auth/react';\nimport { useRouter } from 'next/navigation';\nimport AdminConsole from '../components/admin/AdminConsole';\nimport { getUserByEmail } from '@/lib/data';\nimport { useEffect, useState } from 'react';\nimport type { User } from '@/types';\n\nexport default function Page() {\n  const { data: session, status } = useSession();\n  const router = useRouter();\n  const [user, setUser] = useState<User | null>(null);\n  const [loading, setLoading] = useState(true);\n  \n  useEffect(() => {\n    async function loadUser() {\n      if (status === 'loading') return;\n      \n      if (!session?.user?.email) {\n        router.push('/auth/login');\n        return;\n      }\n      \n      try {\n        const userData = await getUserByEmail(session.user.email);\n        if (!userData || !userData.isSuperAdmin) {\n          router.push('/');\n          return;\n        }\n        setUser(userData);\n      } catch (error) {\n        console.error('Error loading user:', error);\n        router.push('/');\n      } finally {\n        setLoading(false);\n      }\n    }\n    \n    loadUser();\n  }, [session, status, router]);\n  \n  if (loading || !user) {\n    return <div className=\"p-8\">Loading...</div>;\n  }\n  \n  return <AdminConsole onBack={() => router.push('/')} />;\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AANA;;;;;;;AASe,SAAS;IACtB,MAAM,EAAE,MAAM,OAAO,EAAE,MAAM,EAAE,GAAG,IAAA,4JAAU;IAC5C,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAc;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACR,eAAe;YACb,IAAI,WAAW,WAAW;YAE1B,IAAI,CAAC,SAAS,MAAM,OAAO;gBACzB,OAAO,IAAI,CAAC;gBACZ;YACF;YAEA,IAAI;gBACF,MAAM,WAAW,MAAM,IAAA,6HAAc,EAAC,QAAQ,IAAI,CAAC,KAAK;gBACxD,IAAI,CAAC,YAAY,CAAC,SAAS,YAAY,EAAE;oBACvC,OAAO,IAAI,CAAC;oBACZ;gBACF;gBACA,QAAQ;YACV,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,uBAAuB;gBACrC,OAAO,IAAI,CAAC;YACd,SAAU;gBACR,WAAW;YACb;QACF;QAEA;IACF,GAAG;QAAC;QAAS;QAAQ;KAAO;IAE5B,IAAI,WAAW,CAAC,MAAM;QACpB,qBAAO,8OAAC;YAAI,WAAU;sBAAM;;;;;;IAC9B;IAEA,qBAAO,8OAAC,sJAAY;QAAC,QAAQ,IAAM,OAAO,IAAI,CAAC;;;;;;AACjD"}}]
}