(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,83079,e=>{"use strict";var t=e.i(43476);e.s(["default",0,({children:e,variant:s="primary",size:a="md",className:r,...l})=>(0,t.jsx)("button",{className:`rounded-md font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${{primary:"bg-amber-600 text-white hover:bg-amber-700 focus:ring-amber-500",secondary:"bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-400",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[s]} ${{md:"px-4 py-2 text-sm",sm:"px-3 py-1.5 text-xs"}[a]} ${r}`,...l,children:e})])},18566,(e,t,s)=>{t.exports=e.r(76562)},2265,e=>{"use strict";var t=e.i(43476);e.s(["default",0,({children:e,className:s,title:a,description:r})=>(0,t.jsxs)("div",{className:`bg-white shadow-md rounded-lg overflow-hidden ${s}`,children:[a&&(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold leading-6 text-gray-900",children:a}),r&&(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:r})]}),(0,t.jsx)("div",{className:"p-6",children:e})]})])},23261,e=>{"use strict";var t,s,a,r,l,i,d,c,o,n,E,m,x=e.i(43476),p=e.i(17255),h=e.i(18566),u=e.i(71645);(t={}).MEMBER="MEMBER",t.STAFF="STAFF",t.CLERGY="CLERGY",t.MODERATOR="MODERATOR",t.ADMIN="ADMIN",(s={}).MEMBER="MEMBER",s.STAFF="STAFF",s.MODERATOR="MODERATOR",(a={}).REQUESTED="REQUESTED",a.APPROVED="APPROVED",a.REJECTED="REJECTED",a.BANNED="BANNED",(r={}).OPEN="OPEN",r.APPROVAL_REQUIRED="APPROVAL_REQUIRED",(l={}).CONFIRMED="CONFIRMED",l.CANCELED="CANCELED",(i={}).LEADER="LEADER",i.MEMBER="MEMBER",(d={}).PRAYER_REQUEST="PRAYER_REQUEST",d.TANGIBLE_NEED="TANGIBLE_NEED",(c={}).PENDING_APPROVAL="PENDING_APPROVAL",c.PUBLISHED="PUBLISHED",c.FULFILLED="FULFILLED",(o={}).PUBLIC="PUBLIC",o.MEMBERS_ONLY="MEMBERS_ONLY",(n={}).PDF="PDF",n.DOCX="DOCX",n.MP3="MP3",n.JPG="JPG",n.PNG="PNG",n.OTHER="OTHER",(E={}).UNREAD="UNREAD",E.READ="READ",E.ARCHIVED="ARCHIVED";var N=((m={}).IMPERSONATE_START="IMPERSONATE_START",m.IMPERSONATE_END="IMPERSONATE_END",m.CREATE_POST="CREATE_POST",m.DELETE_POST="DELETE_POST",m.BAN_USER="BAN_USER",m.UNBAN_USER="UNBAN_USER",m.DELETE_MESSAGE="DELETE_MESSAGE",m.USER_JOINED_TENANT="USER_JOINED_TENANT",m.MEMBERSHIP_STATUS_UPDATED="MEMBERSHIP_STATUS_UPDATED",m.MEMBER_ROLES_UPDATED="MEMBER_ROLES_UPDATED",m.MEMBERSHIP_PROFILE_UPDATED="MEMBERSHIP_PROFILE_UPDATED",m.USER_REGISTERED="USER_REGISTERED",m.USER_PROFILE_UPDATED="USER_PROFILE_UPDATED",m.ADMIN_UPDATED_USER_PROFILE="ADMIN_UPDATED_USER_PROFILE",m.TENANT_PERMISSIONS_UPDATED="TENANT_PERMISSIONS_UPDATED",m),g=e.i(31487),f=e.i(83079),y=e.i(2265);let R=({onBack:e})=>{let[t,s]=(0,u.useState)([]),[a,r]=(0,u.useState)([]),[l,i]=(0,u.useState)(!0);(0,u.useEffect)(()=>{!async function(){try{let[e,t]=await Promise.all([(0,g.getAuditLogs)(),(0,g.getAllUsers)()]);s(e),r(t)}catch(e){console.error("Error fetching admin data:",e)}finally{i(!1)}}()},[]);let[d,c]=(0,u.useState)("all"),[o,n]=(0,u.useState)("all"),[E,m]=(0,u.useState)(""),[p,h]=(0,u.useState)(""),R=(0,u.useMemo)(()=>{let e=new Map;return a.forEach(t=>e.set(t.id,t)),e},[a]),A=(0,u.useMemo)(()=>t.map(e=>({...e,actorDisplayName:R.get(e.actorUserId)?.profile?.displayName||e.actorUserId,effectiveDisplayName:e.effectiveUserId?R.get(e.effectiveUserId)?.profile?.displayName||e.effectiveUserId:void 0})),[t,R]),D=(0,u.useMemo)(()=>A.filter(e=>{if("all"!==d&&e.actorUserId!==d||"all"!==o&&e.actionType!==o)return!1;if(E){let t=new Date(E);if(e.createdAt<t)return!1}if(p){let t=new Date(p);if(t.setHours(23,59,59,999),e.createdAt>t)return!1}return!0}),[A,d,o,E,p]);return l?(0,x.jsxs)("div",{className:"space-y-8",children:[(0,x.jsx)("div",{className:"flex justify-between items-center",children:(0,x.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Console: Audit Log"})}),(0,x.jsx)("div",{className:"text-center py-8",children:"Loading..."})]}):(0,x.jsxs)("div",{className:"space-y-8",children:[(0,x.jsxs)("div",{className:"flex justify-between items-center",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Console: Audit Log"}),(0,x.jsx)("p",{className:"text-sm text-gray-500",children:"View and filter all audited actions across the platform."})]}),(0,x.jsx)(f.default,{variant:"secondary",onClick:e,children:"â† Back"})]}),(0,x.jsx)(y.default,{title:"Filter Logs",children:(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"actor-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Actor"}),(0,x.jsxs)("select",{id:"actor-filter",value:d,onChange:e=>c(e.target.value),className:"w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-amber-500 focus:border-amber-500 sm:text-sm bg-white text-gray-900",children:[(0,x.jsx)("option",{value:"all",children:"All Users"}),a.map(e=>(0,x.jsx)("option",{value:e.id,children:e.profile.displayName},e.id))]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"action-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Action Type"}),(0,x.jsxs)("select",{id:"action-filter",value:o,onChange:e=>n(e.target.value),className:"w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-amber-500 focus:border-amber-500 sm:text-sm bg-white text-gray-900",children:[(0,x.jsx)("option",{value:"all",children:"All Actions"}),Object.values(N).map(e=>(0,x.jsx)("option",{value:e,children:e},e))]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),(0,x.jsx)("input",{type:"date",id:"start-date",value:E,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-amber-500 focus:border-amber-500 sm:text-sm bg-white text-gray-900"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"end-date",className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),(0,x.jsx)("input",{type:"date",id:"end-date",value:p,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-amber-500 focus:border-amber-500 sm:text-sm bg-white text-gray-900"})]})]})}),(0,x.jsx)("div",{className:"flow-root",children:(0,x.jsx)("div",{className:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8",children:(0,x.jsx)("div",{className:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8",children:(0,x.jsx)("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg",children:(0,x.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,x.jsx)("thead",{className:"bg-gray-50",children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6",children:"Date"}),(0,x.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Actor"}),(0,x.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Effective User"}),(0,x.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Action"}),(0,x.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Entity"}),(0,x.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Details"})]})}),(0,x.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:D.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6",children:e.createdAt.toLocaleString()}),(0,x.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.actorDisplayName}),(0,x.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.effectiveDisplayName||"N/A"}),(0,x.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.actionType}),(0,x.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.entityType?`${e.entityType} (${e.entityId})`:"N/A"}),(0,x.jsx)("td",{className:"px-3 py-4 text-xs text-gray-500",children:e.metadata&&(0,x.jsx)("pre",{className:"bg-gray-100 p-2 rounded whitespace-pre-wrap max-w-sm",children:JSON.stringify(e.metadata,null,2)})})]},e.id))})]})})})})})]})};function A(){let{data:e,status:t}=(0,p.useSession)(),s=(0,h.useRouter)(),[a,r]=(0,u.useState)(null),[l,i]=(0,u.useState)(!0);return((0,u.useEffect)(()=>{!async function(){if("loading"!==t){if(!e?.user?.email)return s.push("/auth/login");try{let t=await (0,g.getUserByEmail)(e.user.email);if(!t||!t.isSuperAdmin)return void s.push("/");r(t)}catch(e){console.error("Error loading user:",e),s.push("/")}finally{i(!1)}}}()},[e,t,s]),l||!a)?(0,x.jsx)("div",{className:"p-8",children:"Loading..."}):(0,x.jsx)(R,{onBack:()=>s.push("/")})}e.s(["default",()=>A],23261)}]);