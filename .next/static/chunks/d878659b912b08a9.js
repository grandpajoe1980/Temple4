(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,83079,e=>{"use strict";var t=e.i(43476);e.s(["default",0,({children:e,variant:s="primary",size:a="md",className:r,...l})=>(0,t.jsx)("button",{className:`rounded-md font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${{primary:"bg-amber-600 text-white hover:bg-amber-700 focus:ring-amber-500",secondary:"bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-400",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[s]} ${{md:"px-4 py-2 text-sm",sm:"px-3 py-1.5 text-xs"}[a]} ${r}`,...l,children:e})])},2265,e=>{"use strict";var t=e.i(43476);e.s(["default",0,({children:e,className:s,title:a,description:r})=>(0,t.jsxs)("div",{className:`bg-white shadow-md rounded-lg overflow-hidden ${s}`,children:[a&&(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold leading-6 text-gray-900",children:a}),r&&(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:r})]}),(0,t.jsx)("div",{className:"p-6",children:e})]})])},18566,(e,t,s)=>{t.exports=e.r(76562)},64807,e=>{"use strict";var t,s,a,r,l,i,d,o,c,n,m=((t={}).MEMBER="MEMBER",t.STAFF="STAFF",t.CLERGY="CLERGY",t.MODERATOR="MODERATOR",t.ADMIN="ADMIN",t),E=((s={}).MEMBER="MEMBER",s.STAFF="STAFF",s.MODERATOR="MODERATOR",s),x=((a={}).REQUESTED="REQUESTED",a.APPROVED="APPROVED",a.REJECTED="REJECTED",a.BANNED="BANNED",a),p=((r={}).OPEN="OPEN",r.APPROVAL_REQUIRED="APPROVAL_REQUIRED",r),u=((l={}).PRAYER_REQUEST="PRAYER_REQUEST",l.TANGIBLE_NEED="TANGIBLE_NEED",l),h=((i={}).PENDING_APPROVAL="PENDING_APPROVAL",i.PUBLISHED="PUBLISHED",i.FULFILLED="FULFILLED",i),y=((d={}).PUBLIC="PUBLIC",d.MEMBERS_ONLY="MEMBERS_ONLY",d),g=((o={}).PDF="PDF",o.DOCX="DOCX",o.MP3="MP3",o.JPG="JPG",o.PNG="PNG",o.OTHER="OTHER",o),N=((c={}).UNREAD="UNREAD",c.READ="READ",c.ARCHIVED="ARCHIVED",c),f=((n={}).IMPERSONATE_START="IMPERSONATE_START",n.IMPERSONATE_END="IMPERSONATE_END",n.CREATE_POST="CREATE_POST",n.DELETE_POST="DELETE_POST",n.BAN_USER="BAN_USER",n.UNBAN_USER="UNBAN_USER",n.DELETE_MESSAGE="DELETE_MESSAGE",n.USER_JOINED_TENANT="USER_JOINED_TENANT",n.MEMBERSHIP_STATUS_UPDATED="MEMBERSHIP_STATUS_UPDATED",n.MEMBER_ROLES_UPDATED="MEMBER_ROLES_UPDATED",n.MEMBERSHIP_PROFILE_UPDATED="MEMBERSHIP_PROFILE_UPDATED",n.USER_REGISTERED="USER_REGISTERED",n.USER_PROFILE_UPDATED="USER_PROFILE_UPDATED",n.ADMIN_UPDATED_USER_PROFILE="ADMIN_UPDATED_USER_PROFILE",n.TENANT_PERMISSIONS_UPDATED="TENANT_PERMISSIONS_UPDATED",n);e.s(["ActionType",()=>f,"CommunityPostStatus",()=>h,"CommunityPostType",()=>u,"ContactSubmissionStatus",()=>N,"FileType",()=>g,"MembershipApprovalMode",()=>p,"MembershipStatus",()=>x,"ResourceVisibility",()=>y,"TenantRole",()=>m,"TenantRoleType",()=>E])},23261,e=>{"use strict";var t=e.i(43476),s=e.i(17255),a=e.i(18566),r=e.i(71645),l=e.i(64807),i=e.i(31487),d=e.i(83079),o=e.i(2265);let c=({onBack:e})=>{let[s,a]=(0,r.useState)([]),[c,n]=(0,r.useState)([]),[m,E]=(0,r.useState)(!0);(0,r.useEffect)(()=>{!async function(){try{let[e,t]=await Promise.all([(0,i.getAuditLogs)(),(0,i.getAllUsers)()]);a(e),n(t)}catch(e){console.error("Error fetching admin data:",e)}finally{E(!1)}}()},[]);let[x,p]=(0,r.useState)("all"),[u,h]=(0,r.useState)("all"),[y,g]=(0,r.useState)(""),[N,f]=(0,r.useState)(""),A=(0,r.useMemo)(()=>{let e=new Map;return c.forEach(t=>e.set(t.id,t)),e},[c]),R=(0,r.useMemo)(()=>s.map(e=>({...e,actorDisplayName:A.get(e.actorUserId)?.profile?.displayName||e.actorUserId,effectiveDisplayName:e.effectiveUserId?A.get(e.effectiveUserId)?.profile?.displayName||e.effectiveUserId:void 0})),[s,A]),D=(0,r.useMemo)(()=>R.filter(e=>{if("all"!==x&&e.actorUserId!==x||"all"!==u&&e.actionType!==u)return!1;if(y){let t=new Date(y);if(e.createdAt<t)return!1}if(N){let t=new Date(N);if(t.setHours(23,59,59,999),e.createdAt>t)return!1}return!0}),[R,x,u,y,N]);return m?(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Console: Audit Log"})}),(0,t.jsx)("div",{className:"text-center py-8",children:"Loading..."})]}):(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Console: Audit Log"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"View and filter all audited actions across the platform."})]}),(0,t.jsx)(d.default,{variant:"secondary",onClick:e,children:"â† Back"})]}),(0,t.jsx)(o.default,{title:"Filter Logs",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"actor-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Actor"}),(0,t.jsxs)("select",{id:"actor-filter",value:x,onChange:e=>p(e.target.value),className:"w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-amber-500 focus:border-amber-500 sm:text-sm bg-white text-gray-900",children:[(0,t.jsx)("option",{value:"all",children:"All Users"}),c.map(e=>(0,t.jsx)("option",{value:e.id,children:e.profile.displayName},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"action-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Action Type"}),(0,t.jsxs)("select",{id:"action-filter",value:u,onChange:e=>h(e.target.value),className:"w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-amber-500 focus:border-amber-500 sm:text-sm bg-white text-gray-900",children:[(0,t.jsx)("option",{value:"all",children:"All Actions"}),Object.values(l.ActionType).map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),(0,t.jsx)("input",{type:"date",id:"start-date",value:y,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-amber-500 focus:border-amber-500 sm:text-sm bg-white text-gray-900"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"end-date",className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),(0,t.jsx)("input",{type:"date",id:"end-date",value:N,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-amber-500 focus:border-amber-500 sm:text-sm bg-white text-gray-900"})]})]})}),(0,t.jsx)("div",{className:"flow-root",children:(0,t.jsx)("div",{className:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8",children:(0,t.jsx)("div",{className:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6",children:"Date"}),(0,t.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Actor"}),(0,t.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Effective User"}),(0,t.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Action"}),(0,t.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Entity"}),(0,t.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Details"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:D.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6",children:e.createdAt.toLocaleString()}),(0,t.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.actorDisplayName}),(0,t.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.effectiveDisplayName||"N/A"}),(0,t.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.actionType}),(0,t.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.entityType?`${e.entityType} (${e.entityId})`:"N/A"}),(0,t.jsx)("td",{className:"px-3 py-4 text-xs text-gray-500",children:e.metadata&&(0,t.jsx)("pre",{className:"bg-gray-100 p-2 rounded whitespace-pre-wrap max-w-sm",children:JSON.stringify(e.metadata,null,2)})})]},e.id))})]})})})})})]})};function n(){let{data:e,status:l}=(0,s.useSession)(),d=(0,a.useRouter)(),[o,n]=(0,r.useState)(null),[m,E]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{!async function(){if("loading"!==l){if(!e?.user?.email)return d.push("/auth/login");try{let t=await (0,i.getUserByEmail)(e.user.email);if(!t||!t.isSuperAdmin)return void d.push("/");n(t)}catch(e){console.error("Error loading user:",e),d.push("/")}finally{E(!1)}}}()},[e,l,d]),m||!o)?(0,t.jsx)("div",{className:"p-8",children:"Loading..."}):(0,t.jsx)(c,{onBack:()=>d.push("/")})}e.s(["default",()=>n],23261)}]);